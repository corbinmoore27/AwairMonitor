<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <canvas id="myChart" width="400" height="400"></canvas>
    <canvas id="myChart2" width="400" height="400"></canvas>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
<script>

    // pm1
    // pm2.5
    // pm10
    // Temp
    // Hum
    // CO
    // NO

    // VARIABLES FOR VALUES
    // =====================================================================================
    // =====================================================================================
    // var PM1
    // var PM25
    // var PM10
    // var Temp
    // var Hum
    // var CO
    // var NO


    // VARIABLES FOR AVERAGE YESTERDAY
    // =====================================================================================
    // =====================================================================================
    var avgYesterdayPM1 = 0;
    var avgYesterdayPM25 = 0;
    var avgYesterdayPM10 = 0;
    var avgYesterdayTemp = 0;
    var avgYesterdayHum = 0;
    var avgYesterdayCO = 0;
    var avgYesterdayNO = 0;



    $.ajax({
        url: "http://localhost:7000/api/reading",
        method: "GET"
    }).then(function (response) {
        console.log(response);
        for (let i = 0; i < response.length; i++) {
            // need to add in filter for only yesterday
            avgYesterdayPM1 += response[i].PM1;

        }
        console.log("average PM1 for yesterday was " + round(avgYesterdayPM1/response.length, 3));

    });


//Function to round numbers to 3 decimal places. It requires 2 variables, the number (number) and how many decimal places you wish to round to (precision)
function round(number, precision) {
  var shift = function (number, precision) {
    var numArray = ("" + number).split("e");
    return +(numArray[0] + "e" + (numArray[1] ? (+numArray[1] + precision) : precision));
  };
  return shift(Math.round(shift(number, +precision)), -precision);
}


//Function that will get the averages for the 7 tracked values from yesterday
function averageYesterday(response, avgYesterdayValue){
    for (let i = 0; i < response.length; i++) {
        avgYesterdayValue = avgYesterdayValue += response[i].value;   
    }
    console.log("average " + value +  " for yesterday was " + round(avgYesterdayValue/response.length, 3));
}



</script>

</html>